<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="google-site-verification" content="TOzgkVPl_tllvkMlt51RjNeTAmmf13oTLBbxTqhSO5E">
<meta name="baidu-site-verification" content="e8tBkAplgA">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Devops,">








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0">






<meta name="description" content="æœ€è¿‘å—äººç†é™¶ï¼Œå‡†å¤‡å°è¯•ä¸€ä¸‹è‡ªå·±æ­å»ºä¸€å¥—è‡ªå·±çš„Devopsï¼Œæ•…æ­¤è®°å½•ä¸€ç•ªã€‚ ğŸ¥•">
<meta name="keywords" content="Devops">
<meta property="og:type" content="article">
<meta property="og:title" content="ç©è€Devops Git+Gogs+Jenkins+Docker">
<meta property="og:url" content="https://7le.top/2017/10/09/ç©è€Devops Git+Gogs+Jenkins+Docker/index.html">
<meta property="og:site_name" content="Shine">
<meta property="og:description" content="æœ€è¿‘å—äººç†é™¶ï¼Œå‡†å¤‡å°è¯•ä¸€ä¸‹è‡ªå·±æ­å»ºä¸€å¥—è‡ªå·±çš„Devopsï¼Œæ•…æ­¤è®°å½•ä¸€ç•ªã€‚ ğŸ¥•">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-1.jpg">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-2.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-3.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-4.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-5.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-6.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-7.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-8.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-9.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-10.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-11.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-12.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-13.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-14.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-15.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-16.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-17.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-18.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-19.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-20.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-21.png">
<meta property="og:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-22.png">
<meta property="og:updated_time" content="2019-07-28T11:58:43.232Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ç©è€Devops Git+Gogs+Jenkins+Docker">
<meta name="twitter:description" content="æœ€è¿‘å—äººç†é™¶ï¼Œå‡†å¤‡å°è¯•ä¸€ä¸‹è‡ªå·±æ­å»ºä¸€å¥—è‡ªå·±çš„Devopsï¼Œæ•…æ­¤è®°å½•ä¸€ç•ªã€‚ ğŸ¥•">
<meta name="twitter:image" content="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-1.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://7le.top/2017/10/09/ç©è€Devops Git+Gogs+Jenkins+Docker/">





  <title> ç©è€Devops Git+Gogs+Jenkins+Docker | Shine </title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.2/gh-fork-ribbon.min.css">
  <script type="text/javascript">
    var host = "7le.top";
    if ((host == window.location.host) && (window.location.protocol != "https:"))
        window.location.protocol = "https";
  </script>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?467d29ed3a4fecd3a1dca094a8c5a369";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Shine</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">è€¶å’Œåæ˜¯æˆ‘çš„ç‰§è€…ï¼Œæˆ‘å¿…ä¸è‡´ç¼ºä¹ã€‚</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://7le.top/2017/10/09/ç©è€Devops Git+Gogs+Jenkins+Docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="7le">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/image/ly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shine">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                ç©è€Devops Git+Gogs+Jenkins+Docker
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-10-09T22:37:30+08:00">
                2017-10-09
              </time>
            

            

            
          </span>

          

          
            
                <span class="post-comments-count">
                  <span class="post-meta-divider">|</span>
                  <span class="post-meta-item-icon">
                    <i class="fa fa-comment-o"></i>
                  </span>
                  <a href="/2017/10/09/ç©è€Devops Git+Gogs+Jenkins+Docker/#comments" itemprop="discussionUrl">
                    <span class="post-comments-count gitment-comments-count" data-xid="/2017/10/09/ç©è€Devops Git+Gogs+Jenkins+Docker/" itemprop="commentsCount"></span>
                  </a>
                </span>
            
          

          
          
             <span id="/2017/10/09/ç©è€Devops Git+Gogs+Jenkins+Docker/" class="leancloud_visitors" data-flag-title="ç©è€Devops Git+Gogs+Jenkins+Docker">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>æœ€è¿‘å—äººç†é™¶ï¼Œå‡†å¤‡å°è¯•ä¸€ä¸‹è‡ªå·±æ­å»ºä¸€å¥—è‡ªå·±çš„Devopsï¼Œæ•…æ­¤è®°å½•ä¸€ç•ªã€‚ ğŸ¥•</p>
</blockquote>
<a id="more"></a>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦äº†è§£Devopsï¼ˆDevelopmentå’ŒOperationsï¼‰ï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªå®Œæ•´çš„é¢å‘ITè¿ç»´çš„å·¥ä½œæµï¼Œä»¥ IT è‡ªåŠ¨åŒ–ä»¥åŠCI,CDä¸ºåŸºç¡€ï¼Œæ¥ä¼˜åŒ–ç¨‹å¼å¼€å‘ã€æµ‹è¯•ã€ç³»ç»Ÿè¿ç»´ç­‰æ‰€æœ‰ç¯èŠ‚ã€‚å…¶ä¸­æŒç»­é›†æˆï¼ˆContinuous integrationï¼Œç®€ç§°CIï¼‰ï¼ŒæŒ‡çš„æ˜¯é¢‘ç¹åœ°ï¼ˆä¸€å¤©å¤šæ¬¡ï¼‰å°†ä»£ç é›†æˆåˆ°ä¸»å¹²ã€‚è€ŒCDï¼Œè¿™ä¸ªæ¦‚å¿µå°±å®¹æ˜“å¼•èµ·æ··æ·†äº†ï¼Œå› ä¸ºCDè¿™ä¸ªç¼©å†™ä»£è¡¨äº†ä¸¤ä¸ªçŸ­è¯­ï¼Œä¸€ä¸ªæ˜¯Continuous Deliveryï¼Œä¸€ä¸ªæ˜¯Continuous Deploymentï¼Œä¸¤è€…çš„åŒºåˆ«å°±æ˜¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒè¿™ä¸€æ­¥éª¤ï¼Œæ˜¯æ‰‹å·¥çš„ï¼Œè¿˜æ˜¯è‡ªåŠ¨çš„ã€‚</p>
<p>è¯¦ç»†çš„å¯ä»¥çœ‹<a href="http://www.ruanyifeng.com/blog/2015/09/continuous-integration.html" target="_blank" rel="noopener">æŒç»­é›†æˆæ˜¯ä»€ä¹ˆï¼Ÿ</a>ã€‚</p>
<p>å½“æˆ‘ä»¬å¤§æ¦‚äº†è§£Devopsä¹‹åï¼Œä¼šå‘ç°äº’è”ç½‘è½¯ä»¶çš„å¼€å‘å’Œå‘å¸ƒæ˜¯ä¸€å¥—ç›¸å¯¹ç¹ççš„æµç¨‹ï¼Œè€Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¸å¤šå·¥å…·ï¼Œæ¥è¿›è¡Œç®€åŒ–ï¼Œæ–¹ä¾¿æ“ä½œï¼Œè¾¾åˆ°è®©äº§å“å¯ä»¥å¿«é€Ÿè¿­ä»£ï¼ŒåŒæ—¶è¿˜èƒ½ä¿æŒé«˜è´¨é‡ã€‚</p>
<p>PSï¼šæ–‡ç« æœ‰ç‚¹é•¿ï¼Œè®°å½•äº†æ•´ä¸ªç¯å¢ƒçš„æ­å»ºçš„ç»†èŠ‚ï¼Œä»¥åŠè¸©çš„å‘ï¼Œç”¨çš„æœåŠ¡å™¨æ˜¯Centos6.5ï¼Œå¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ¬¢è¿æ‹ç –è®¨è®ºã€‚</p>
<h3 id="Git-Gogs"><a href="#Git-Gogs" class="headerlink" title="Git+Gogs"></a>Git+Gogs</h3><blockquote>
<p>git å¤§å®¶æ—©å·²è€³ç†Ÿèƒ½è¯¦ï¼Œè€Œgogsæ˜¯åŸºäºGoè¯­è¨€çš„è‡ªåŠ©GitæœåŠ¡,å›¾å½¢åŒ–ç•Œé¢è·Ÿgithubéå¸¸ç›¸ä¼¼ã€‚</p>
</blockquote>
<p>ä¸€èˆ¬è¦æ­å»ºè‡ªå·±çš„gitä»“åº“ï¼Œç°åœ¨çš„é€‰æ‹©å¤§å¤šéƒ½æ˜¯Gitlabæˆ–è€…Gogsã€‚ä¸¤è€…åˆ†åˆ«æœ‰å„è‡ªçš„ä¼˜åŠ¿ï¼Œè€ƒè™‘è‡ªå·±å¯æ€œçš„æœåŠ¡å™¨é…ç½®ï¼Œæ¯«æ— ç–‘é—®æˆ‘çš„é€‰æ‹©ä¼šæ˜¯æ›´åŠ è½»é‡çš„Gogsã€‚</p>
<h4 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h4><p>Gitä¸€èˆ¬å¤§å®¶çš„æœåŠ¡å™¨éƒ½ä¼šå·²ç»å®‰è£…ï¼Œå¯ä»¥é€šè¿‡ <code>git --version</code> æŸ¥çœ‹ã€‚å¦‚æœç‰ˆæœ¬è¿‡ä½ï¼Œæœ€å¥½å‡çº§ä¸‹ï¼Œæˆ‘åŸå…ˆæ˜¯1.7.*çš„ç‰ˆæœ¬çš„ï¼Œåæ¥å‡ºç°äº†ç‚¹é—®é¢˜ã€‚</p>
<h5 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h5><p><code>cd</code>åˆ°è‡ªå·±æœåŠ¡å™¨å­˜æ”¾åŒ…çš„è·¯å¾„ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/git/git/archive/v2.3.0.zip</span><br></pre></td></tr></table></figure>
<h5 id="è§£å‹"><a href="#è§£å‹" class="headerlink" title="è§£å‹"></a>è§£å‹</h5><p>å› ä¸ºä¸‹è½½çš„æ˜¯ä¸ªzipåŒ…ï¼Œ<code>unzip v2.3.0 -d git</code> è¿›è¡Œè§£å‹</p>
<h5 id="ç¼–è¯‘å®‰è£…"><a href="#ç¼–è¯‘å®‰è£…" class="headerlink" title="ç¼–è¯‘å®‰è£…"></a>ç¼–è¯‘å®‰è£…</h5><p>è¿›å…¥gitç›®å½•ï¼Œå°†å…¶å®‰è£…åœ¨â€œ/usr/local/gitâ€ç›®å½•ä¸‹,å‘½ä»¤å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make prefix=/usr/local/git all</span><br><span class="line">sudo make prefix=/usr/local/git install</span><br></pre></td></tr></table></figure></p>
<p>ä¹‹åç¼–è¾‘<code>/etc/profile</code>æ­¤æ–‡ä»¶,åœ¨æœ€ä¸‹è¾¹æ·»åŠ gitçš„è·¯å¾„ï¼š<code>export PATH=/usr/local/git/bin:$PATH</code></p>
<p>è¿è¡Œ<code>source /etc/profile</code></p>
<p>æœ€åæ£€éªŒ<code>git --version</code></p>
<h4 id="Gogs"><a href="#Gogs" class="headerlink" title="Gogs"></a>Gogs</h4><h5 id="ä¸‹è½½-1"><a href="#ä¸‹è½½-1" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h5><p>Gogs åœ¨Githubæ˜¯å¼€æºçš„ï¼Œå¯ä»¥åœ¨<a href="https://github.com/gogits/gogs/releases" target="_blank" rel="noopener">Gogsç‰ˆæœ¬ä¸‹è½½åœ°å€</a> ä¸‹è½½è‡ªå·±éœ€è¦çš„ç‰ˆæœ¬ã€‚æˆ‘ä¸‹è½½çš„æ˜¯æœ€æ–°ç‰ˆæœ¬v0.11.29çš„linux_amd64.tar.gzã€‚</p>
<h5 id="è§£å‹-1"><a href="#è§£å‹-1" class="headerlink" title="è§£å‹"></a>è§£å‹</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tar -xzvf linux_amd64.tar.gz</span><br></pre></td></tr></table></figure>
<h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><p>è¿›å…¥åˆ°åˆšåˆšè§£å‹åçš„ç›®å½•æ‰§è¡Œå‘½ä»¤<code>./gogs web</code><br>ç„¶ååœ¨æµè§ˆå™¨è¾“å…¥<code>http://ip:3000</code><br>ä¼šå‡ºç°å¦‚ä¸‹å›¾ç‰‡ï¼š<img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-1.jpg" alt="Gogsé…ç½®å›¾ç‰‡"><br>æ ¹æ®å®é™…æƒ…å†µé…ç½®å³å¯ã€‚é…ç½®åå°±å¯ä»¥ä½¿ç”¨äº†ï¼Œå¯ä»¥æ³¨å†Œè‡ªå·±çš„å¸å·ï¼Œæ“ä½œè·ŸGithubå¦‚å‡ºä¸€è¾™ã€‚</p>
<p>ç»è¿‡ä¸€ç•ªæŠ˜è…¾åï¼Œ<img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-2.png" alt="silk&#39;s Gogs"></p>
<p>è¿™æ ·å°±å®Œæˆäº†ç¬¬ä¸€æ­¥ï¼Œæ­å»ºGit+Gogsã€‚<br>PSï¼šåå°è¿è¡Œå‘½ä»¤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup ./gogs web &gt; nohup.out 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure></p>
<p>ä»¥åŠå®˜æ–¹æ–‡æ¡£çš„<a href="https://gogs.io/docs/upgrade/upgrade_from_binary" target="_blank" rel="noopener">ç‰ˆæœ¬å‡çº§</a></p>
<h3 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h3><h4 id="å®‰è£…Jenkins"><a href="#å®‰è£…Jenkins" class="headerlink" title="å®‰è£…Jenkins"></a>å®‰è£…Jenkins</h4><p>å®‰è£…å®ŒGitå’ŒGogsä¹‹å,æ¥ä¸‹æ¥å°±æ˜¯æˆ‘ä»¬çš„ä¸»è§’jenkinsäº†ã€‚jenkinså®‰è£…æ¯”è¾ƒç®€å•ï¼Œ<br>æ‰§è¡Œå‘½ä»¤æ–¹å¯å®Œæˆã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install jenkins</span><br></pre></td></tr></table></figure></p>
<p>å®‰è£…ä¹‹åå¯åŠ¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service jenkins start</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœéœ€è¦ä¿®æ”¹ç«¯å£ï¼Œè·¯å¾„åœ¨<code>/etc/sysconfig/jenkins</code>ï¼Œä¿®æ”¹<code>JENKINS_PORT=&quot;your_port&quot;</code>ã€‚é‡å¯jenkinsæœåŠ¡ã€‚</p>
<p>è¿›å…¥çš„ç•Œé¢å¦‚ä¸‹ï¼Œè¡¨ç¤ºå¯åŠ¨æˆåŠŸ</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-3.png" alt="jenkisæˆåŠŸç™»å½•"></p>
<p>PS:é¦–æ¬¡ç™»å½•ï¼Œæ˜¯æ²¡æœ‰å³è¾¹çš„ä»»åŠ¡ï¼Œé‚£æ˜¯æˆ‘å·²ç»æ·»åŠ äº†çš„ã€‚</p>
<h4 id="Jenkins-æ’ä»¶"><a href="#Jenkins-æ’ä»¶" class="headerlink" title="Jenkins æ’ä»¶"></a>Jenkins æ’ä»¶</h4><p>ç™»å½•éƒ½OKä¹‹åï¼Œå°±éœ€è¦ä¸ºjenkinsä¸‹è½½æ’ä»¶äº†ã€‚</p>
<p>å› ä¸ºæˆ‘ä»¬æ˜¯é€šè¿‡gitå»æ‹‰å–ä»£ç ï¼Œéœ€è¦å®‰è£…ï¼Œä¸€èˆ¬æ˜¯è‡ªå¸¦äº†ï¼Œå¦‚æœæ²¡æœ‰å°±å®‰è£…ä¸€ä¸‹ï¼Œéå¸¸ç®€ä¾¿ã€‚</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-4.png" alt="jenkisæ’ä»¶"></p>
<p>å…¶ä¸­<code>Gogs plugin</code>ä¹Ÿéœ€è¦å®‰è£…ï¼Œåç»­çš„hookä¼šç”¨åˆ°ã€‚è¿˜è¦å®‰è£…<code>Pipeline</code>ï¼Œè¿™ä¸ªæ˜¯æŒç»­äº¤ä»˜çš„é‡å¤´æˆï¼Œä»¥åŠ<code>Publish Over SSH</code> è¿™ä¸ªæ˜¯ç”¨æ¥è¿œç¨‹éƒ¨ç½²çš„ã€‚</p>
<h4 id="Jenkins-é…ç½®"><a href="#Jenkins-é…ç½®" class="headerlink" title="Jenkins é…ç½®"></a>Jenkins é…ç½®</h4><p>é…ç½®åªéœ€è¦æŒ‰ç…§è‡ªå·±çš„æœåŠ¡å™¨çš„å®é™…æƒ…å†µå¡«å†™ï¼Œé…ç½®çš„åœ°æ–¹ä¸º<code>ç³»ç»Ÿç®¡ç†</code>-&gt;<code>Global Tool Configuration</code></p>
<h5 id="Jdk"><a href="#Jdk" class="headerlink" title="Jdk"></a>Jdk</h5><p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-5.png" alt="jdk"></p>
<h5 id="Git-1"><a href="#Git-1" class="headerlink" title="Git"></a>Git</h5><p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-6.png" alt="git"></p>
<h5 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h5><p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-7.png" alt="maven"></p>
<p>å¦‚æœè¿˜æ²¡å®‰è£…mavenï¼Œå°±ä¸‹è½½æ”¾åˆ°æœåŠ¡å™¨ã€‚æˆ‘ç”¨çš„æ˜¯<code>apache-maven-3.3.9-bin.tar.gz</code></p>
<p>è§£å‹å åœ¨<code>/etc/profile</code>ä¸­æ·»åŠ <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export M2_HOME=/software/apache-maven-3.3.9</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin:$M2_HOME/bin</span><br></pre></td></tr></table></figure></p>
<p>åŸºæœ¬é…ç½®å°±å·®ä¸å¤šäº†ï¼Œå»ºè®®æ³¨å†Œå¸å·ï¼Œæé«˜å®‰å…¨æ€§ä¹Ÿæ–¹ä¾¿åç»­æ“ä½œã€‚</p>
<p>æˆ‘çš„Configure Global Securityæ˜¯è¿™æ ·é…ç½®çš„ï¼Œè¿™ä¸ªæŒ‰ç…§è‡ªå·±çš„éœ€è¦ï¼Œå¦‚æœåƒæˆ‘è¿™æ ·é…ç½®ï¼Œå°±éœ€è¦ç™»å½•å¸å·ã€‚<br><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-8.png" alt="Configure Global Security"></p>
<h4 id="åˆ›å»ºJob"><a href="#åˆ›å»ºJob" class="headerlink" title="åˆ›å»ºJob"></a>åˆ›å»ºJob</h4><p>å‰é¢çš„æ“ä½œéƒ½å®Œæˆä¹‹åï¼Œç‚¹å‡»<code>My views</code> â€“&gt; <code>æ–°å»º</code></p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-9.png" alt="æ–°å»ºjob"></p>
<h5 id="Maven-project"><a href="#Maven-project" class="headerlink" title="Maven project"></a>Maven project</h5><p>å…ˆè®°å½•ä½¿ç”¨mavenå®ç°ï¼Œè¾“å…¥é¡¹ç›®åç§°ï¼Œé€‰æ‹©mavené¡¹ç›®æŒ‰é’®ã€‚</p>
<p>æºç ç®¡ç†é€‰æ‹©gitï¼Œå¡«å†™è‡ªå·±gogsçš„URLã€‚ä¾‹å¦‚æˆ‘çš„videoé¡¹ç›®ã€‚</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-10.png" alt="gogs-video"></p>
<p>å¯¹åº”å¡«å†™ç›¸å…³å‚æ•°ï¼š<br><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-11.png" alt="maven-project1"></p>
<p>æ„å»ºè§¦å‘å™¨ï¼Œå°±æ˜¯ä»€ä¹ˆæ—¶å€™æ‰§è¡Œjenkinsçš„è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ªï¼Œå…¶ä»–çš„åŸºæœ¬æ˜¯å®šæ—¶æ‰§è¡Œä»€ä¹ˆçš„ï¼Œæœ‰å…´è¶£éƒ½å¯ä»¥å»å°è¯•ä¸€ä¸‹</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-12.png" alt="maven-project2"></p>
<p>Buildå’ŒPost Stepsè®¾ç½®:</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-13.png" alt="maven-project3"></p>
<p>Execute shell è„šæœ¬(å¸¦äº†æ³¨è§£ï¼Œæ”¾å…¥é…ç½®çš„æ—¶å€™å¯ä»¥æŠŠæ³¨é‡Šå»æ‰)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/usr/local/jdk1.8.0_73</span><br><span class="line">#export BUILD_ID=dontKillMeè¿™ä¸€å¥å¾ˆé‡è¦ï¼Œå› ä¸ºè¯¥jobå¯åŠ¨å®Œåæ‰§è¡Œä¸‹ä¸€job,jenkinsç›´æ¥æŠŠtomcatè¿›ç¨‹æ€äº†</span><br><span class="line">export BUILD_ID=dontKillMe</span><br><span class="line"></span><br><span class="line">project=video-0.0.1.jar</span><br><span class="line">#jenkinsçš„è·¯å¾„</span><br><span class="line">file_path=/var/lib/jenkins/workspace/video/target</span><br><span class="line"></span><br><span class="line">sleep 3s </span><br><span class="line"># æŸ¥çœ‹æœåŠ¡æ˜¯å¦å·²ç»å¯åŠ¨ï¼Œå¯åŠ¨äº†å°±å…ˆkill</span><br><span class="line">pid=$(lsof -i:9000 |awk &apos;&#123;print $2&#125;&apos; | tail -n 1)</span><br><span class="line"></span><br><span class="line">if [ &quot;$pid&quot; != &quot;&quot; ] </span><br><span class="line">echo &quot;close old video&quot;</span><br><span class="line">then</span><br><span class="line">echo $pid</span><br><span class="line">kill -9 $pid</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;begin new video&quot;</span><br><span class="line"></span><br><span class="line">cd $file_path</span><br><span class="line"># springboot åå°éƒ¨ç½²æ–¹å¼</span><br><span class="line">java -jar $&#123;project&#125; &amp;</span><br></pre></td></tr></table></figure></p>
<p>é‚®ä»¶è®¾ç½®ï¼š</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-14.png" alt="maven-project4"></p>
<p>è®¾ç½®å®Œæˆåï¼Œç‚¹å‡»ä¿å­˜ã€‚è·³è½¬åˆ°æ–°çš„é¡µé¢ï¼Œç‚¹å‡»é¡µé¢ä¸Šçš„<code>ç«‹å³æ„é€ </code>å°±ä¼šå¼€å§‹è¿è¡Œäº†ã€‚</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-15.png" alt="maven-project5"></p>
<p>è¿è¡Œçš„æ—¶å€™å¯ä»¥ç‚¹å‡»<code>console Output</code>æŸ¥çœ‹æ—¥å¿—ã€‚</p>
<p>ç­‰åˆ°å°å¤ªé˜³å‡ºç°ï¼ŒæŸ¥çœ‹ä¸‹è‡ªå·±çš„é¡¹ç›®ï¼Œå·²ç»å¯åŠ¨äº†ï¼Œé‚£å°±å¤§åŠŸææˆæ‹‰~ å¦‚æœå¾ˆæ‚²å‰§çš„å‡ºç°é—®é¢˜äº†ï¼Œé‚£å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„è¸©å‘è®°å½•ä¸­çš„ä¸œè¥¿èƒ½ä¸èƒ½å¸®åˆ°ä½ äº†~</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-16.png" alt="maven-project6"></p>
<h5 id="pipeline"><a href="#pipeline" class="headerlink" title="pipeline"></a>pipeline</h5><p>pipelineæ˜¯jenkins2.0çš„ä¸€å¤§äº®ç‚¹ï¼Œåœ¨æ–°å»ºä»»åŠ¡çš„æ—¶å€™é€‰æ‹©Pipelineã€‚</p>
<p>pipelineè®¾ç½®ï¼š<br><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-17.png" alt="pipeline"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">node &#123;  </span><br><span class="line"></span><br><span class="line">    stage(&apos;checkout&apos;)&#123;</span><br><span class="line">        echo &apos;checkout from git&apos;</span><br><span class="line">        git url: &apos;http://114.215.122.158:3000/silk_gogs/video.git&apos;, branch: &apos;master&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    stage(&apos;Test&apos;) &#123;            </span><br><span class="line">        echo &quot;Test start...&quot;</span><br><span class="line">        sh &apos;mvn clean &apos;</span><br><span class="line">    &#125;        </span><br><span class="line">    stage(&apos;Build&apos;) &#123;            </span><br><span class="line">        echo &quot;Deploy start...&quot;</span><br><span class="line">        sh &apos; mvn package -Dmaven.test.skip=true&apos;</span><br><span class="line">        sh &apos; sh /root/video-pipeline.sh&apos;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>pipeline é‡‡ç”¨çš„æ˜¯Groovyè¯­æ³•ï¼Œ</p>
<ol>
<li>Stageï¼šè¡¨ç¤ºå½“å‰è¿›è¡Œçš„é˜¶æ®µï¼Œåå­—å¯ä»¥éšæ„å»ï¼Œå¦‚ï¼šgitã€buildã€testã€buildç­‰</li>
<li>Node:åé¢æ¥ä¸€ä¸ªå°æ‹¬å·å’Œä¸€ä¸ªå¤§æ‹¬å·ï¼Œå°æ‹¬å·æŒ‡å®šèŠ‚ç‚¹çš„åå­—æˆ–æ ‡ç­¾ï¼ˆç¼ºçœæ—¶éšæœºé€‰æ‹©èŠ‚ç‚¹ï¼‰ï¼Œå¤§æ‹¬å·è¡¨ç¤ºåœ¨è¯¥èŠ‚ç‚¹è¿è¡Œçš„å†…å®¹</li>
<li>Step:åƒgitã€echoã€shã€archiveArtifactsç­‰è¿™äº›æŒ‡ä»¤ï¼Œä¸€ä¸ªæŒ‡ä»¤å°±æ˜¯ä¸€ä¸ªstep</li>
</ol>
<p>Groovyè„šæœ¬ä¸­è°ƒç”¨çš„shellè„šæœ¬,è·Ÿmavené¡¹ç›®çš„å·®ä¸å¤šã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/usr/local/jdk1.8.0_73</span><br><span class="line">export BUILD_ID=dontKillMe</span><br><span class="line"></span><br><span class="line">project=video-0.0.1.jar</span><br><span class="line">file_path=/var/lib/jenkins/workspace/video-pipeline/target</span><br><span class="line"></span><br><span class="line">sleep 3s </span><br><span class="line"></span><br><span class="line">pid=$(lsof -i:9000 |awk &apos;&#123;print $2&#125;&apos; | tail -n 1)</span><br><span class="line"></span><br><span class="line">if [ &quot;$pid&quot; != &quot;&quot; ] </span><br><span class="line">then</span><br><span class="line">echo &quot;close old video&quot;</span><br><span class="line">echo $pid</span><br><span class="line">kill -9 $pid</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;begin new video:$file_path/$&#123;project&#125;&quot;</span><br><span class="line"></span><br><span class="line">nohup java -jar $file_path/$&#123;project&#125; &gt; nohup.out  2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line">echo &quot;end ^.^&quot;</span><br></pre></td></tr></table></figure></p>
<p>ç‚¹å‡»<code>ç«‹å³æ„é€ </code>ï¼š<br><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-18.png" alt="pipeline"></p>
<p>è·Ÿmaven projectä¸åŒçš„æ˜¯å¤šäº†è®¸å¤šçš„Stageå—ï¼Œéå¸¸ç›´è§‚ï¼Œè€Œä¸”æ”¯æŒå¤æ‚çš„CD(Continuous Delivery)éœ€æ±‚,è¿˜æœ‰è®¸å¤šæœ‰è¶£çš„ç‚¹ç­‰æœ‰æ—¶é—´å†å»ç©è€ã€‚</p>
<h4 id="Gogs-plugin"><a href="#Gogs-plugin" class="headerlink" title="Gogs plugin"></a>Gogs plugin</h4><p>ä¹‹å‰åœ¨å®‰è£…æ’ä»¶çš„æ—¶å€™ï¼Œç‰¹æ„å®‰è£…äº†Gogs pluginï¼Œè¿™ä¸ªæ’ä»¶æ˜¯å¹²å˜›çš„å‘¢ï¼Ÿæˆ‘ä»¬ä¹‹å‰çš„æ“ä½œéƒ½æ˜¯é€šè¿‡æ‰‹åŠ¨è§¦å‘çš„ï¼Œè¿™ä¸ªæ’ä»¶å¯ä»¥å¸®æˆ‘ä»¬å®ç°ä»£ç çš„pushæ“ä½œè§¦å‘ï¼ˆè¿˜æœ‰å…¶ä»–çš„hookäº‹ä»¶ï¼‰ï¼Œç‚¹å‡»è¿™ä¸ªæ’ä»¶è¿›å»å¯ä»¥çœ‹åˆ°</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-19.png" alt="Gogs plugin"></p>
<p>å¾ˆæ˜æ˜¾çš„å‘Šè¯‰æˆ‘ä»¬ï¼Œåªéœ€è¦åœ¨gogsçš„é¡¹ç›®ä¸­é…ç½®webhook</p>
<p><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-20.png" alt="Gogs hook"></p>
<p>è¿™æ ·å°±å¯ä»¥å®ç°ä»£ç <code>push</code>å°±è§¦å‘æ•´ä¸ªæµç¨‹äº†ã€‚</p>
<h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><blockquote>
<p>å¾…æ•´ç†å‡ºæ¥è¡¥å……~</p>
</blockquote>
<h3 id="è¸©å‘è®°å½•"><a href="#è¸©å‘è®°å½•" class="headerlink" title="è¸©å‘è®°å½•"></a>è¸©å‘è®°å½•</h3><h4 id="Maven-JVM-terminated-unexpectedly-with-exit-code-137"><a href="#Maven-JVM-terminated-unexpectedly-with-exit-code-137" class="headerlink" title="Maven JVM terminated unexpectedly with exit code 137"></a>Maven JVM terminated unexpectedly with exit code 137</h4><p>é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼ŒåŸå› æ˜¯æˆ‘çš„æœåŠ¡å™¨é…ç½®æ¯”è¾ƒå·®ï¼Œjenkinsè¿˜æ˜¯åƒé…ç½®çš„ã€‚é€‰æ‹©ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æœåŠ¡å™¨ï¼Œå°±å¯ä»¥çœå»è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœè·Ÿæˆ‘ä¸€æ ·ï¼ŒæœåŠ¡å™¨ä¸å¤ªå¥½çš„è¯ã€‚</p>
<p>è§£å†³çš„æ–¹æ³•:</p>
<ol>
<li><p>åœ¨<code>/etc/profile</code> ä¸­æ·»åŠ <code>export _JAVA_OPTIONS=&quot;-Xmx500m&quot;</code> -Xmxæ˜¯jvmçš„æœ€å¤§å †å¤§å°ï¼Œé»˜è®¤å€¼ä¸ºç‰©ç†å†…å­˜çš„1/4,è¿™è¾¹å¯ä»¥æ ¹æ®æƒ…å†µæ‰‹åŠ¨è°ƒå¤§ã€‚</p>
</li>
<li><p>æ‰§è¡ŒLinuxé‡Šæ”¾å†…å­˜å‘½ä»¤ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sync   #æŠŠå†…å­˜æ•°æ®åŒæ­¥åˆ°ç¡¬ç›˜ï¼ˆæœ‰éœ€è¦å¯ä»¥æ‰§è¡Œï¼‰</span><br><span class="line">echo 3 &gt; /proc/sys/vm/drop_caches  #åˆ é™¤å†…å­˜ç¼“å­˜ã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ†å‡ºswapã€‚ åœ¨linuxä¸­è¾“å…¥å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">swapon -s #ç¢ºèªç›®å‰çš„swapå¤§å°</span><br><span class="line">dd if=/dev/zero of=/swapfile bs=1024 count=1048576 #å¢åŠ 1Gçš„ç©ºé—´</span><br><span class="line">mkswap /swapfile  #æ ¼å¼åŒ–swapfile</span><br><span class="line">swapon /swapfile  #å¯åŠ¨swapfile</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>æœ€åè¾“å…¥<code>free -m</code>ï¼ŒæŸ¥çœ‹å†…å­˜åŠswapæƒ…å†µ<br><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-21.png" alt="free -m"></p>
<p>è¿™æ ·ä¸€é¡¿æ“ä½œï¼Œå…«ä¹ä¸ç¦»åå°±èƒ½è§£å†³137çš„é—®é¢˜äº†ï¼Œå› ä¸ºä¹Ÿå¾ˆéš¾æ‰¾åˆ°æ¯”æˆ‘æœåŠ¡å™¨æ›´å·®çš„æœºå™¨äº†â€¦</p>
<h4 id="æƒé™é—®é¢˜"><a href="#æƒé™é—®é¢˜" class="headerlink" title="æƒé™é—®é¢˜"></a>æƒé™é—®é¢˜</h4><p>æ—¥å¿—ä¸­å‡ºç° XXXXX permission deniedã€‚</p>
<p>å¦‚æœæ˜¯è¿è¡Œè°ƒç”¨åˆ°å…¶ä»–æ–‡ä»¶ï¼Œæƒé™ä¸å¤Ÿï¼Œå¯ä»¥<code>chown -R jenkins /xxx/xxx</code>,æœ€å¥½çš„æ˜¯è®¾ç½®ç”¨æˆ·ç»„ï¼Œè¿™æ ·çš„è¯æ¯”è¾ƒç®€å•ç²—æš´ã€‚</p>
<p>ä½†æ˜¯æˆ‘æ˜¯maven installå‡ºæ¥çš„jaråŒ… æ²¡æœ‰æƒé™è¿è¡Œï¼Œè¿™ä¸æ˜¯å‘æˆ‘ä¹ˆã€‚æœ¬æ¥æƒ³åœ¨shè„šæœ¬ä¸­åˆ‡åˆ°rootç”¨æˆ·çš„ï¼Œå°è¯•äº†å‡ ç§æ–¹æ³•éƒ½æœªæœï¼Œäºæ˜¯å°±ç”¨äº†ç²—æš´çš„æ–¹å¼â€¦</p>
<p>ç›´æ¥ä¿®æ”¹<code>/etc/sysconfig/jenkins</code> ä¸­çš„<code>JENKINS_USER=&quot;root&quot;</code> ï¼Œå†ä¿®æ”¹ä¸‹æƒé™<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chown -R root:root /var/lib/jenkins</span><br><span class="line">chown -R root:root /var/cache/jenkins</span><br><span class="line">chown -R root:root /var/log/jenkins</span><br></pre></td></tr></table></figure></p>
<p>æœ€åè®°å¾—ä¿®æ”¹åé‡å¯ä¸‹jenkins</p>
<h4 id="command-not-found"><a href="#command-not-found" class="headerlink" title="command not found"></a>command not found</h4><p>æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­çš„æ—¥å¿—æŠ¥é”™ï¼Œå‡ºç°XXX command not foundï¼Œä½†æ˜¯æœåŠ¡å™¨ä¸­æ˜æ˜å·²ç»æ˜¯æœ‰ç›¸åº”çš„è½¯ä»¶ã€‚è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ï¼Œåœ¨æœåŠ¡å™¨ä¸­è¾“å…¥<code>echo $PATH</code></p>
<p>å°†ä¸€é•¿æ®µç¯å¢ƒå˜é‡å¤åˆ¶åˆ°é…ç½®ä¸­ï¼Œå°±OKäº†<br><img src="https://github.com/7le/7le.github.io/raw/master/image/devops/Devops-22.png" alt="ç¯å¢ƒå˜é‡é…ç½®"></p>
<h4 id="é¡¹ç›®æ— æ³•åå°è¿è¡Œ"><a href="#é¡¹ç›®æ— æ³•åå°è¿è¡Œ" class="headerlink" title="é¡¹ç›®æ— æ³•åå°è¿è¡Œ"></a>é¡¹ç›®æ— æ³•åå°è¿è¡Œ</h4><p>å‡ºç°è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œjenkins çš„jobæ˜¾ç¤ºæ˜¯successçš„ï¼Œä½†æ˜¯æŸ¥çœ‹è‡ªå·±çš„æœåŠ¡å™¨ï¼Œå¯¹åº”çš„é¡¹ç›®æ­»æ´»èµ·ä¸æ¥ã€‚ç»è¿‡ä¸€ç•ªgoogleï¼Œåœ¨jenkinsçš„å®˜ç½‘ä¸­æ‰¾åˆ°äº†ç­”æ¡ˆã€‚<br><a href="https://wiki.jenkins.io/display/JENKINS/ProcessTreeKiller" target="_blank" rel="noopener">jenkins-ProcessTreeKiller</a>,å¤§æ¦‚çš„æ„æ€å°±æ˜¯è¯´jenkinsçš„ç‰¹æ€§ä¼šæ€æ‰åœ¨ä»»åŠ¡ä¸­è¿è¡Œçš„ç”Ÿæˆçš„è¿›ç¨‹ã€‚<code>To reliably kill processes spawned by a job during a build</code> å°±æ˜¯è¿™å¥è¯ã€‚</p>
<p>é‚£æˆ‘ä»¬åªéœ€è¦å…³æ‰è¿™ä¸ªç‰¹æ€§å°±å¯ä»¥äº†ï¼ŒåŒæ ·ä¿®æ”¹<code>/etc/sysconfig/jenkins</code> ä¸­çš„<code>JENKINS_JAVA_OPTIONS=&quot;-Djava.awt.headless=true -Dhudson.util.ProcessTree.disable=true&quot;</code> è®°å¾—ä¿®æ”¹åé‡å¯ä¸‹jenkins</p>
<p>ç½—é‡Œå§å—¦äº†ä¸€å †ï¼Œå¸Œæœ›å¤§å®¶ä¹Ÿéƒ½èƒ½é¡ºåˆ©æ­å»ºèµ·æ¥~ </p>
<hr>
<p><a href="https://github.com/7le" target="_blank" rel="noopener">Github</a> ä¸è¦åå•¬ä½ çš„star ^.^<br><a href="https://7le.top">æ›´å¤šç²¾å½© æˆ³æˆ‘</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Devops/" rel="tag"># Devops</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/08/29/threadLocal å°è®°/" rel="next" title="threadLocal å°è®°">
                <i class="fa fa-chevron-left"></i> threadLocal å°è®°
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/11/08/TiDBï¼Œæ—¥å‡åƒä¸‡çº§æ•°æ®å­˜å‚¨æ–¹æ¡ˆé€‰å‹/" rel="prev" title="TiDBï¼Œæ—¥å‡åƒä¸‡çº§æ•°æ®å­˜å‚¨æ–¹æ¡ˆé€‰å‹">
                TiDBï¼Œæ—¥å‡åƒä¸‡çº§æ•°æ®å­˜å‚¨æ–¹æ¡ˆé€‰å‹ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8yOTIxNS81Nzgy"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/image/ly.jpg" alt="7le">
          <p class="site-author-name" itemprop="name">7le</p>
           
              <p class="site-description motion-element" itemprop="description">æˆ‘åªæœ‰ä¸€ä»¶äº‹ï¼Œå°±æ˜¯å¿˜è®°èƒŒåï¼ŒåŠªåŠ›é¢å‰çš„</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">27</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/7le" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://palmer.arkstack.cn" title="palmerye" target="_blank">palmerye</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Git-Gogs"><span class="nav-number">1.</span> <span class="nav-text">Git+Gogs</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Git"><span class="nav-number">1.1.</span> <span class="nav-text">Git</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¸‹è½½"><span class="nav-number">1.1.1.</span> <span class="nav-text">ä¸‹è½½</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è§£å‹"><span class="nav-number">1.1.2.</span> <span class="nav-text">è§£å‹</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ç¼–è¯‘å®‰è£…"><span class="nav-number">1.1.3.</span> <span class="nav-text">ç¼–è¯‘å®‰è£…</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gogs"><span class="nav-number">1.2.</span> <span class="nav-text">Gogs</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ä¸‹è½½-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">ä¸‹è½½</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è§£å‹-1"><span class="nav-number">1.2.2.</span> <span class="nav-text">è§£å‹</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å®‰è£…"><span class="nav-number">1.2.3.</span> <span class="nav-text">å®‰è£…</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Jenkins"><span class="nav-number">2.</span> <span class="nav-text">Jenkins</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å®‰è£…Jenkins"><span class="nav-number">2.1.</span> <span class="nav-text">å®‰è£…Jenkins</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Jenkins-æ’ä»¶"><span class="nav-number">2.2.</span> <span class="nav-text">Jenkins æ’ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Jenkins-é…ç½®"><span class="nav-number">2.3.</span> <span class="nav-text">Jenkins é…ç½®</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Jdk"><span class="nav-number">2.3.1.</span> <span class="nav-text">Jdk</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Git-1"><span class="nav-number">2.3.2.</span> <span class="nav-text">Git</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Maven"><span class="nav-number">2.3.3.</span> <span class="nav-text">Maven</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åˆ›å»ºJob"><span class="nav-number">2.4.</span> <span class="nav-text">åˆ›å»ºJob</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Maven-project"><span class="nav-number">2.4.1.</span> <span class="nav-text">Maven project</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#pipeline"><span class="nav-number">2.4.2.</span> <span class="nav-text">pipeline</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gogs-plugin"><span class="nav-number">2.5.</span> <span class="nav-text">Gogs plugin</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker"><span class="nav-number">3.</span> <span class="nav-text">Docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¸©å‘è®°å½•"><span class="nav-number">4.</span> <span class="nav-text">è¸©å‘è®°å½•</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Maven-JVM-terminated-unexpectedly-with-exit-code-137"><span class="nav-number">4.1.</span> <span class="nav-text">Maven JVM terminated unexpectedly with exit code 137</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æƒé™é—®é¢˜"><span class="nav-number">4.2.</span> <span class="nav-text">æƒé™é—®é¢˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#command-not-found"><span class="nav-number">4.3.</span> <span class="nav-text">command not found</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é¡¹ç›®æ— æ³•åå°è¿è¡Œ"><span class="nav-number">4.4.</span> <span class="nav-text">é¡¹ç›®æ— æ³•åå°è¿è¡Œ</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
<div class="copyright">
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <a class="theme-link" href="https://github.com/7le" target="view_window" style="cursor: pointer" rel="external nofollow">
    7le
  </a>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io" rel="external nofollow">Hexo</a>
</div>

<span id="busuanzi_container_site_pv">
  PV <span id="busuanzi_value_site_pv"></span>
</span>
<span id="busuanzi_container_site_uv">
  &nbsp&nbsp | &nbsp&nbsp UV <span id="busuanzi_value_site_uv"></span>
</span>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  








  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitmint({
            id: window.location.pathname,
            owner: '7le',
            repo: '7le.github.io',
            
            lang: "" || navigator.language || navigator.systemLanguage || navigator.userLanguage,
            
            oauth: {
            
            
                client_secret: 'c53d2248f8cd0c5003b8c92b5a9e27299cf96e99',
            
                client_id: '36f5a95fff3d8ff6cadd'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("tNiTejf4rdhMUUhMzh7SEzUI-gzGzoHsz", "qhTCrCTlLqVQcfs3eAwwuqqB");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  <a class="github-fork-ribbon left-bottom fixed" href="https://github.com/7le" data-ribbon="Follow me on GitHub" title="Follow me on GitHub">Follow me on GitHub</a>
</body>
</html>



